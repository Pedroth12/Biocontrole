---
title: ""
---

# Modelo misto

Um modelo misto serve pra analisar dados com **estrutura hier√°rquica**, **medidas repetidas** ou **varia√ß√£o agrupada**. Esse modelo combina **efeitos fixos** (tratamento aplicado, que queremos **testar e comparar**) e **efeitos aleat√≥rios** (fontes de varia√ß√£o aleat√≥ria, como plantas, folhas, avaliadores, etc.).

Nossos dados cont√©m **v√°rios n√≠veis hier√°rquicos**: Planta ‚Üí Trif√≥lio ‚Üí Fol√≠olo

Optamos pelo uso de um modelo misto devido √† estrutura hier√°rquica dos dados experimentais, nos quais as observa√ß√µes de severidade foram feitas em fol√≠olos pertencentes a trif√≥lios, dentro de plantas, avaliadas por diferentes observadores. Essa organiza√ß√£o gera depend√™ncia entre as medi√ß√µes, violando a suposi√ß√£o de independ√™ncia dos erros em modelos lineares tradicionais. O modelo misto permite considerar essa varia√ß√£o estrutural por meio de efeitos aleat√≥rios, isolando o efeito espec√≠fico dos tratamentos (efeito fixo) e proporcionando uma an√°lise mais precisa e robusta do impacto das diferentes estrat√©gias de manejo sobre a progress√£o da ferrugem asi√°tica.

### Ativando os Pacotes necess√°rios para a an√°lise

```{r}
library(tidyverse)
library(pracma)
library(lme4)
library(lmerTest)
library(pbkrtest)
library(readxl)
```

### Importando os dados

```{r}
dados <- read_excel("Trabalho final Emerson.xlsx", sheet = "Planilha1")
```

### Calculando AACPD (sem transforma√ß√£o)

```{r}
aacpd_result <- dados %>%
  group_by(Tratamento, Planta, Trifolio, Foliolo, Avaliador) %>%
  summarise(
    AACPD = trapz(Dia, Severidade),
    .groups = "drop"
  )
```

Aqui ele calcula o **AACPD** (√Årea Abaixo da Curva de Progresso da Doen√ßa), que √© uma medida comum para doen√ßas em plantas.

üîß Usa a fun√ß√£o `trapz()` para calcular a **√°rea sob a curva** da severidade ao longo dos dias.

### Ajustando o modelo completo (com tratamento)

```{r}
modelo_completo <- lmer(
  AACPD ~ Tratamento + (1 | Planta/Trifolio/Foliolo/Avaliador),
  data = aacpd_result,
  REML = FALSE  # necess√°rio para compara√ß√£o de modelos
)
```

**`AACPD ~ Tratamento`**: est√° testando o efeito fixo do **Tratamento** sobre o AACPD.

-   **`(1 | Planta/Trifolio/Foliolo/Avaliador)`**: estrutura hier√°rquica de efeitos aleat√≥rios:

    Avalia√ß√µes foram feitas em *fol√≠olos* dentro de *trif√≥lios*, dentro de *plantas*, e cada uma foi avaliada por um **Avaliador**.

    Isso ajuda a **controlar a varia√ß√£o natural** desses n√≠veis e evitar que confundam o efeito do tratamento.

    `REML = FALSE`: usa m√°xima verossimilhan√ßa (ML) e **n√£o REML**, pois vai comparar modelos (√© o certo nesse caso).

### Ajustando o modelo nulo (sem tratamento)

```{r}
modelo_nulo <- lmer(
  AACPD ~ 1 + (1 | Planta/Trifolio/Foliolo/Avaliador),
  data = aacpd_result,
  REML = FALSE
)
```

√â igual ao modelo anterior, **mas sem o efeito fixo de Tratamento**. Serve como **base de compara√ß√£o**.

### Compara√ß√£o robusta por bootstrap

```{r}
comparacao_robusta <- PBmodcomp(modelo_completo, modelo_nulo, nsim = 1000)
print(comparacao_robusta)
```

-   Ele comparou os dois modelos com **bootstrap param√©trico** (via `PBmodcomp`).

    Isso gerou um **p-valor mais robusto**, mesmo se os dados n√£o fossem perfeitamente normais.

Para analisar o efeito dos tratamentos sobre a progress√£o da ferrugem asi√°tica da soja, utilizamos um modelo de efeitos mistos, que permite considerar a estrutura hier√°rquica dos dados (planta, trif√≥lio, fol√≠olo e avaliador) como fontes de varia√ß√£o aleat√≥ria. A vari√°vel resposta foi a √°rea abaixo da curva de progresso da doen√ßa (AACPD), calculada para cada fol√≠olo. O efeito fixo de interesse foi o tratamento, enquanto os demais fatores foram tratados como efeitos aleat√≥rios. A compara√ß√£o entre o modelo completo (com tratamento) e o modelo nulo (sem tratamento), realizada via bootstrap, indicou se o tratamento teve efeito significativo sobre a severidade acumulada da doen√ßa, controlando a variabilidade natural do experimento.
