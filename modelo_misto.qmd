---
title: ""
---

# Modelo misto

```{r}
# Pacotes necessários
library(tidyverse)
library(pracma)
library(lme4)
library(lmerTest)
library(pbkrtest)
library(readxl)

# Importar os dados
dados <- read_excel("Trabalho final Emerson.xlsx", sheet = "Planilha1")

# 1. Calcular AACPD (sem transformação)
aacpd_result <- dados %>%
  group_by(Tratamento, Planta, Trifolio, Foliolo, Avaliador) %>%
  summarise(
    AACPD = trapz(Dia, Severidade),
    .groups = "drop"
  )

# 2. Ajustar o modelo completo (com tratamento)
modelo_completo <- lmer(
  AACPD ~ Tratamento + (1 | Planta/Trifolio/Foliolo/Avaliador),
  data = aacpd_result,
  REML = FALSE  # necessário para comparação de modelos
)

# 3. Ajustar o modelo nulo (sem tratamento)
modelo_nulo <- lmer(
  AACPD ~ 1 + (1 | Planta/Trifolio/Foliolo/Avaliador),
  data = aacpd_result,
  REML = FALSE
)

# 4. Comparação robusta por bootstrap
comparacao_robusta <- PBmodcomp(modelo_completo, modelo_nulo, nsim = 1000)
print(comparacao_robusta)


```
